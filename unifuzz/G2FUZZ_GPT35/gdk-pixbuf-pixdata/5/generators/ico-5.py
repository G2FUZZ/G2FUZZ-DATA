import io
import struct

# Create ICO header
icon_header = struct.pack(
    '<HHH',
    0,  # Reserved
    1,  # Type (1 for ICO, 2 for CUR)
    1   # Number of images
)

# Create ICO image directory
image_directory = struct.pack(
    '<BBBBHHII',
    32,   # Width
    32,   # Height
    0,    # Color count
    0,    # Reserved
    1,    # Color planes
    32,   # Bits per pixel
    1024, # Image size
    22    # Offset
)

# Create ICO image data
image_data = bytearray([
    0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
    0x10, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
    0x40, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00,
    0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
    0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
    0x0C, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
])

# Combine all parts
ico_data = icon_header + image_directory + image_data

# Save the ICO file
with open('./tmp/metadata_icon.ico', 'wb') as f:
    f.write(ico_data)